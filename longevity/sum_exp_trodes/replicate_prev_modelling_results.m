% REPLICATE_PREV_MODELLING_RESULTS
%
%% Fit the model or load results
P=get_parameters;
data_path = P.sum_exp_trodes.data_replicate_path;
refit = false;
if ~isfile(data_path) || refit
    mdl_params = {'N1_const', ...
                  'N1_AP', ...
                  'N1_DV', ...
                  'N1_DV_gtn2', ...
                  'N1_ML', ...
                  'k_AP', ...
                  'k_DV_gtn2', ...
                  'k_ML', ...
                  'k_SP', ...
                  'k_SO'};
    S = sum_exp_trodes_select_mdl(Cells, 'Iterations', 1, ...10, ...
                                         'KFold', 5, ...
                                         'noise', 'poisson', ...
                                         'model_parameters', mdl_params);
%     S = sum_exp_trodes_compute_CI(S, 'i_mdl', 1:5);
    S = sum_exp_trodes_compute_CI(S, 'i_mdl', 1);
    save(data_path, 'S')
else
    load(data_path, 'S')
end
%% Plot
sum_exp_trodes_plot_coef(S, 'mdl_inds', 1:5)